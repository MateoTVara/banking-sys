{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" href="{% static 'css/portal/navbar.css' %}?v=1.0">
  <link rel="stylesheet" href="{% static 'css/portal/client_depo/forms.css' %}?v=1.2">
  
  <title>Retiros - Portal Cliente</title>
</head>
<body>
  
  <header class="main-header">
  </header>

  <!-- Barra de navegación horizontal -->
  <nav class="top-navbar">
    <div class="nav-container">
      <a href="{% url 'portal:dashboard' %}" class="nav-link">
        <span class="nav-text">Inicio</span>
      </a>
      <a href="#" class="nav-link">
        <span class="nav-text">Aperturar Cuenta</span>
      </a>
      <a href="{% url 'portal:deposito' %}" class="nav-link">
        <span class="nav-text">Depósitos</span>
      </a>
      <a href="{% url 'portal:retiro' %}" class="nav-link active">
        <span class="nav-text">Retiros</span>
      </a>
      <a href="#" class="nav-link">
        <span class="nav-text">Transferencia</span>
      </a>
      <a href="#" class="nav-link">
        <span class="nav-text">Historial</span>
      </a>
    </div>
  </nav>
  <div class="message-container">
    {% if messages %}
      <ul class="messages">
        {% for message in messages %}
          <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
            {{ message }}
          </li>
        {% endfor %}
      </ul>
    {% endif %} 
  </div>

  <!-- Contenido principal de la página -->
  <main class="container-split">

    <!-- Columna Izquierda (Info) -->
    <section class="client-details-column">
      <div class="client-info-card">
        <h3>{{ client.name }}</h3>
        <div class="info-row">
          <span>DNI:</span>
          <span>{{ client.dni }}</span>
        </div>
        <div class="info-row">
          <span>Tipo:</span>
          <span>{{ client.get_client_type_display }}</span>
        </div>
      </div>
      <div class="account-list">
        {% for account in accounts %}
          <div class="account-card">
            <div class="account-info">
              <span class="account-number">{{ account.account_number }}</span>
              <span class="account-type">{{ account.get_account_type_display }}</span>
            </div>
            <div class="account-balance">
              <span class="balance-amount">{{ account.balance|floatformat:2 }}</span>
              <span class="balance-currency">{{ account.get_currency_display }}</span>
            </div>
          </div>
        {% empty %}
          <p>No tienes cuentas registradas.</p>
        {% endfor %}
      </div>
    </section>

    <!-- Columna Derecha (Formulario) -->
    <section class="form-column">
      <h2>Realizar un Retiro</h2>
      <p>Selecciona la cuenta de origen y el monto a retirar.</p>
      
      <!-- ¡Importante! El 'action' apunta a 'portal:retiro' -->
      <form class="deposit-form" method="POST" action="{% url 'portal:retiro' %}">
        {% csrf_token %}
        
        <div class="form-group">
          <label for="account">Cuenta de Origen:</label>
          <select id="account" name="account_id" required>
            <option value="">-- Seleccione una cuenta --</option>
            {% for acc in accounts %}
              <option value="{{ acc.id }}">
                N° {{ acc.account_number }} ({{ acc.get_account_type_display }})
              </option>
            {% endfor %}
          </select>
        </div>

        <div class="form-group">
          <label for="amount">Monto a Retirar:</label>
          <input type="number" id="amount" name="amount" step="0.01" min="1.00" placeholder="Ej: 50.00" required>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary">Confirmar Retiro</button>
        </div>
      </form>
    </section>
  </main>

  <!-- Pie de página -->
  <footer class="main-footer">
    <p>© 2025 Banco Digital - Todos los derechos reservados</p>
  </footer>

</body>
</html>
